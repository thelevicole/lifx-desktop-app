"use strict";!function(t){var e=!1,i=new Vue({el:"[vue-app]",data:{access_token:localStorage.getItem("lifx_access_token"),lights:[],light:null},mounted:function(){this.authenticate()},computed:{ordered_lights:function(){return _.orderBy(this.lights,"label")}},methods:{authenticate:function(){var i=this;this.access_token?(localStorage.setItem("lifx_access_token",this.access_token),e=new Lifx(this.access_token),t(this.$el).addClass("loading"),e.list_lights().then(function(e){t(i.$el).removeClass("loading"),i.lights=e},function(e){t(i.$el).removeClass("loading"),e.error&&alert(e.error)})):(localStorage.removeItem("lifx_access_token"),e=!1)},logout:function(){localStorage.removeItem("lifx_access_token"),e=!1,location.reload()},update_light:function(e,i){for(var o=0;o<this.lights.length;o++)if(this.lights[o].id===e)return this.lights[o]=t.extend(!0,this.lights[o],i),this.lights[o];return!1},get_light:function(t){for(var e=0;e<this.lights.length;e++)if(this.lights[e].id===t)return this.lights[e];return!1}}});Vue.component("light-switch",{props:["data"],template:"#light-switch-template",computed:{percentage:function(){return"on"===this.data.power?100*this.data.brightness+", 100":"0, 100"},linecap:function(){return"on"===this.data.power?"round":"butt"},hex_color:function(){var t,e,i=this.data.color.hue,o=this.data.color.saturation,n=[];if(0===o)t=[1,1,1];else switch(n=[1*(1-o),1*(1-o*((i/=60)-(e=Math.floor(i)))),1*(1-o*(1-(i-e)))],e){case 0:t=[1,n[2],n[0]];break;case 1:t=[n[1],1,n[0]];break;case 2:t=[n[0],1,n[2]];break;case 3:t=[n[0],n[1],1];break;case 4:t=[n[2],n[0],1];break;default:t=[1,n[0],n[1]]}return"#"+t.map(function(t){return("0"+Math.round(255*t).toString(16)).slice(-2)}).join("")}},methods:{toggle:function(){return this.data.power="on"===this.data.power?"off":"on",e.set_state("id:"+this.data.id,{power:this.data.power}),!1},set:function(){return i.light=this.data,!1}}}),Vue.component("color-picker",{template:"#color-picker-template",methods:{close:function(){return i.light=null,!1}},computed:{light:function(){return i.light}},mounted:function(){var o=this.light,n=!1;t(this.$el).LifxColorPicker({brightness:o.brightness,hue:o.color.hue,saturation:o.color.saturation,changed:function(t){n&&clearTimeout(n),n=setTimeout(function(){e.set_color("id:"+o.id,t.hue,t.saturation,t.brightness),i.update_light(o.id,{color:{hue:t.hue,saturation:t.saturation},brightness:t.brightness,power:o.power})},500)}})}})}(jQuery);