"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function Lifx(t){var e=this;if(e.base_url="https://api.lifx.com/v1/",e.token=t,!e.token)throw"An API Authorization token is required. See: https://api.developer.lifx.com/docs/authentication";var n=function(t){t=t||{};for(var e=1;e<arguments.length;e++)if(arguments[e])for(var n in arguments[e])arguments[e].hasOwnProperty(n)&&(t[n]=arguments[e][n]);return t};e.api={},e.api.call=function(t,n,r,o){if(n=n.replace(/^(\/)/,""),r=r||{},o="string"==typeof o?o:"lights/","object"===(void 0===r?"undefined":_typeof(r)))for(var i in r)r[i]||delete r[i];return function(t,n,r){return new Promise(function(o,i){var s=new XMLHttpRequest;s.open(t.toUpperCase(),n,!0),s.setRequestHeader("Authorization","Bearer "+e.token),s.setRequestHeader("Content-type","application/json; charset=utf-8"),s.onload=function(){s.status>=200&&s.status<400?o(JSON.parse(s.responseText)):i(JSON.parse(s.responseText))},s.onerror=function(){i(JSON.parse(s.responseText))},s.send(JSON.stringify(r||{}))})}(t,e.base_url+(o.trim()?o:"/")+n,r)},e.api.post=function(t,n,r){return e.api.call("post",t,n,r)},e.api.get=function(t,n,r){return e.api.call("get",t,n,r)},e.api.put=function(t,n,r){return e.api.call("put",t,n,r)};var r=function(t){return(t="string"==typeof t?t:"all").replace(/^(\/)/,"").replace(/$(\/)/,""),t};e.list_lights=function(t){return t=r(t),e.api.get(t)},e.set_state=function(t,o){t=r(t);var i=n({power:"",color:"",brightness:null,duration:null,infrared:null},o||{});return e.api.put(t+"/state",i)},e.set_states=function(t,n){return e.api.put("states",{states:t||[],defaults:n||{}})},e.state_delta=function(t){throw t=r(t),"This function is currently not available."},e.toggle_power=function(t,o){t=r(t);var i=n({duration:null},o||{});return e.api.post(t+"/toggle",i)},e.breath_effect=function(t,o){t=r(t);var i=n({color:"",from_color:"",period:null,cycles:null,persist:!1,power_on:!0,peak:null},o||{});return e.api.post(t+"/effects/breathe",i)},e.pulse_effect=function(t,o){t=r(t);var i=n({color:"",from_color:"",period:null,cycles:null,persist:!1,power_on:!0},o||{});return e.api.post(t+"/effects/pulse",i)},e.cycle=function(t,o){t=r(t);var i=n({states:[],defaults:{},direction:"forward"},o||{});return e.api.post(t+"/cycle",i)},e.list_scenes=function(){return e.api.get("scenes",!1,"")},e.activate_scene=function(t,r){var o=n({duration:null,ignore:[],overrides:{}},r||{});return e.api.put("scenes/"+t+"/activate",o,"")},e.validate_color=function(t){return e.api.get("color",{string:t},"")},e.set_color=function(t,n,r,o){return e.set_state(t,{color:"hue:"+n+" saturation:"+r+" kelvin:3500"+(o?" brightness:"+o:"")})},e.set_white=function(t,n,r){return e.set_state(t,{color:"hue:0.0 saturation:0.0 kelvin:"+n+(r?" brightness:"+r:"")})}}module.exports=Lifx;