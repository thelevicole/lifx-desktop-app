"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function Lifx(t){var e=this;if(e.base_url="https://api.lifx.com/v1/",e.token=t,!e.token)throw"An API Authorization token is required. See: https://api.developer.lifx.com/docs/authentication";var n=function(t){t=t||{};for(var e=1;e<arguments.length;e++)if(arguments[e])for(var n in arguments[e])arguments[e].hasOwnProperty(n)&&(t[n]=arguments[e][n]);return t},r=function(t,n,r){return new Promise(function(o,i){var a=new XMLHttpRequest;a.open(t.toUpperCase(),n,!0),a.setRequestHeader("Authorization","Bearer "+e.token),"GET"!==t&&a.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),a.onload=function(){a.status>=200&&a.status<400?o(JSON.parse(a.responseText)):i(JSON.parse(a.responseText))},a.onerror=function(){i(JSON.parse(a.responseText))},a.send(function t(e,n){var r=[];for(var o in e)if(e.hasOwnProperty(o)){var i=n?n+"["+o+"]":o,a=e[o];r.push(null!==a&&"object"===(void 0===a?"undefined":_typeof(a))?t(a,i):encodeURIComponent(i)+"="+encodeURIComponent(a))}return r.join("&")}(r||{}))})};e.api={},e.api.call=function(t,n,o,i){if(n=n.replace(/^(\/)/,""),o=o||{},i="string"==typeof i?i:"lights/","object"===(void 0===o?"undefined":_typeof(o)))for(var a in o)o[a]||delete o[a];return r(t,e.base_url+(i.trim()?i:"/")+n,o)},e.api.post=function(t,n,r){return e.api.call("post",t,n,r)},e.api.get=function(t,n,r){return e.api.call("get",t,n,r)},e.api.put=function(t,n,r){return e.api.call("put",t,n,r)};var o=function(t){return(t="string"==typeof t?t:"all").replace(/^(\/)/,"").replace(/$(\/)/,""),t};e.list_lights=function(t){return t=o(t),e.api.get(t)},e.set_state=function(t,r){t=o(t);var i=n({power:"",color:"",brightness:null,duration:null,infrared:null},r||{});return e.api.put(t+"/state",i)},e.set_states=function(t,n){return e.api.put("states",{states:t||[],defaults:n||{}})},e.state_delta=function(t){throw t=o(t),"This function is currently not available."},e.toggle_power=function(t,r){t=o(t);var i=n({duration:null},r||{});return e.api.post(t+"/toggle",i)},e.breath_effect=function(t,r){t=o(t);var i=n({color:"",from_color:"",period:null,cycles:null,persist:!1,power_on:!0,peak:null},r||{});return e.api.post(t+"/effects/breathe",i)},e.pulse_effect=function(t,r){t=o(t);var i=n({color:"",from_color:"",period:null,cycles:null,persist:!1,power_on:!0},r||{});return e.api.post(t+"/effects/pulse",i)},e.cycle=function(t,r){t=o(t);var i=n({states:[],defaults:{},direction:"forward"},r||{});return e.api.post(t+"/cycle",i)},e.list_scenes=function(){return e.api.get("scenes",!1,"")},e.activate_scene=function(t,r){var o=n({duration:null,ignore:[],overrides:{}},r||{});return e.api.put("scenes/"+t+"/activate",o,"")},e.validate_color=function(t){return e.api.get("color",{string:t},"")},e.set_color=function(t,n,r,o){return e.set_state(t,{color:"hue:"+n+" saturation:"+r+" kelvin:3500"+(o?" brightness:"+o:"")})},e.set_white=function(t,n,r){return e.set_state(t,{color:"hue:0.0 saturation:0.0 kelvin:"+n+(r?" brightness:"+r:"")})}}module.exports=Lifx;